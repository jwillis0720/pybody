from pathlib import Path
from sadie.utility.util import get_consensus_of_paired_end_abi


def test_abi_consensus_check():
    abi_file_1 = "tests/unit/utility/fixtures/ab1_files/pe/fwd_read.ab1"
    abi_file_1_path = Path(abi_file_1)
    abi_file_2 = "tests/unit/utility/fixtures/ab1_files/pe/rev_read.ab1"
    abi_file_2_path = Path(abi_file_2)
    assert all([abi_file_1_path.exists(), abi_file_2_path.exists()])
    consensus_seq = get_consensus_of_paired_end_abi(abi_file_1_path, abi_file_2_path)
    assert (
        consensus_seq
        == "CAGACAGCCNCATAGTTAGCGTAACGATCTAAAGTTTTGTCGTCTTTCCAGACGTTAGTAAATGAATTTTCTGTATGAGGTTTTGCTAAACAACTTTCAACAGTTTCGGCCTAAGAAGCATAGTCCGGCACATCATACGGATATGCGCCATGATGGTGGTGATGGTGTTGGCCTCCCGGGCCTTTTATCTCAACTTTTGTTCCTTGTCCGAAGGTGAGTGGGAACTTGAAGCCTTGCTGGCAGTAATACACTGCGACATCCTCAGGCTGAAGGGAGCTTATGGTAAAGGAGAAATCAGTCCCGGATCCACTCCCACTGAAGCGACTAGGTACACCCGTGGCCAGAGAATTCGTGGCGTAGATGAGGAGCTTCGGTGCCTGGCCTGGTTTCTGCTGGTACCAGGCCAGGCTATTGGAAATTGACTCGCTGGCGCGGCAGGTAATGGTTACTTTCTCGCCCTGGCTTAAGGAGAGGGAAGCCGGGCTCTGAGTCATAACTATTTCAGAACCACCGCCGCCTGAACCTCCTCCACCAGAACCACCACCACCACTCGAGACGGTAACCAAAGTCCCCTGTCCCCAGATATCGAAATACCAATGCAGATAATAGGCATCATAGTAGTAGATACTAGCGCAGTAGTACATAGCGGTATCCTCTGCCCGAAGTGAGTTCATTTGCAGATACACGGTGTTTTTGGCATTATCACGACTAATGGTGAACCGCCCCTTAACGGCGTCCGTGTAGTCAGTGCCACCGTTGGACCAAATTGTAGCCACGAGCTGGAGCCCCTTCCCCGGAGCCTGCCGCACCCAACTCATGGAGTTAGAAGTAACACTGAGTCCGCTGGCAACACAAGACAGTCTCAGTGATCCCGCTGGTTTAACGAGATCGCCGCCTGATTCTACAAGCTGAACTTCAGCCATGGCCGGCTGGGCCGCGAGTAATAACAATCCAGCGGCCGCCGTAGGCAATAGGTATTTCATTATGACTGTCTCCTTGAATTCAAATTGTTATCCGCTCACANNCC"
    )
